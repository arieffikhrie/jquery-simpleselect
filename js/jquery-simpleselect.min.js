(function(e,t,n,r){function o(t,n){this.element=t;this.settings=e.extend({},s,n);this._defaults=s;this._name=i;this.init()}var i="simpleSelect",s={speed:0,debug:false};e.expr[":"].firstChar=jQuery.expr.createPseudo(function(t){return function(n){return e(jQuery(n)).text().toUpperCase().charCodeAt(0)==t.charCodeAt(0)}});o.prototype={_debug:function(e){if(this.settings.debug){console.log(e)}},init:function(){var t=this,n=e(this.element);if(n.attr("multiple")!==r&&n.attr("multiple")!==false){t._multiple()}else{t._single()}n.hide()},_single:function(){var t=this,i=e(this.element),s=i.find("option"),o=e("<span>",{"class":"selectbox-text",text:i.find("option:selected").text()}),u=e("<span>",{"class":"selectbox-arrow"}),a=e("<div>",{"class":"selectbox",tabindex:0}).append(o).append(u).append(this._createOption(s).hide());i.after(a);this.val(i.val());var a=i.next();a.on({click:function(r){r.stopPropagation();r.preventDefault();this.focus();t._debug("mainclick trigger");e(n).one("click",function(e){t._debug("document click trigger");t.close()});t.val(i.val());t.toggle()},focusout:function(e){t.close();t._debug("focusout trigger")},blur:function(e){t.close();t._debug("blur trigger")},keydown:function(n){var i=[];if(n.keyCode===9){t.close();return}else{n.preventDefault()}var s=e(a).find("li a").length==e(a).find("li a.disabled").length;if(n.keyCode===13){a.trigger("click")}else if(n.keyCode>=39&&n.keyCode<=40){i=a.find("li a.selected").closest("li").next().children("a");if(i.length==0){i=a.find("li:first a")}if(s){i=e()}while(i.is(".disabled")&&!s){i=i.closest("li").next().children("a");if(i.length==0){i=a.find("li:first a")}}}else if(n.keyCode>=37&&n.keyCode<=38){i=a.find("li a.selected").closest("li").prev().children("a");if(i.length==0){i=a.find("li:last a")}if(s){i=e()}while(i.is(".disabled")&&!s){i=i.closest("li").prev().children("a");if(i.length==0){i=a.find("li:last a")}}}else{i=a.find('li a:firstChar("'+String.fromCharCode(n.keyCode)+'").selected');if(i.length==0){i=a.find('li a:firstChar("'+String.fromCharCode(n.keyCode)+'")').closest("li").first().children("a");while(i.is(".disabled")){i=i.closest("li").next().children("a");if(i.length==0||!i.is(':firstChar("'+String.fromCharCode(n.keyCode)+'")')){i=e()}}}else if(i.hasClass("selected")){i=i.closest("li").next().children("a");while(i.is(".disabled")){i=i.closest("li").next().children("a")}if(i.length==0||!i.is(':firstChar("'+String.fromCharCode(n.keyCode)+'")')){i=a.find('li a:firstChar("'+String.fromCharCode(n.keyCode)+'")').closest("li").first().children("a")}}}if(i.length>0){a.find("li a.selected").removeClass("selected");var o=i.addClass("selected").closest("li").position();t.val(i.attr("rel"));if(o!==r){a.children(".selectbox-box").scrollTop(o.top+a.children(".selectbox-box").scrollTop())}}}});a.on({mousedown:function(e){e.stopPropagation();e.preventDefault();var n=a.find(".selectbox-box li a.selected");if(n.length>0){t.val(n.attr("rel"));t.close();a.off("focusout");t._debug("list click")}else{t.open()}},click:function(e){e.stopPropagation();e.preventDefault()},mouseenter:function(){a.find(".selectbox-box li a.selected").removeClass("selected");if(!e(this).is(".disabled")){e(this).addClass("selected")}}},".selectbox-box li a")},_multiple:function(){var t=this,n=e(this.element),r=n.find("option"),i=e("<div>",{"class":"selectbox multiple",tabindex:0}).append(this._createOption(r));n.after(i);this.val(n.val())},_createOption:function(t){selectboxList=e("<ul>",{"class":"selectbox-box"});t.each(function(){var t={rel:e(this).val(),href:"#"+e(this).val(),text:e(this).text()};if(e(this).attr("disabled")!==r&&e(this).attr("disabled")!==false){t["class"]="disabled"}selectboxList.append(e("<li>").append(e("<a>",t)))});return selectboxList},val:function(t){var n=e(this.element),i=n.next();if(t===r||t===null||t.length===0){return n.val()}else{n.val(t);n.trigger("change");i.find(".selectbox-box li a.selected").removeClass("selected");var s=i.find('.selectbox-box li a[rel="'+t+'"]').addClass("selected");i.children(".selectbox-text").text(s.text())}},open:function(t){var n=this,i=e(this.element),s=i.next();s.children(".selectbox-box").stop().slideDown(n.settings.speed);s.css("z-index","9999");if(t!==r&&typeof t[0]==="function"){t[0]()}},close:function(t){var n=this,i=e(this.element),s=i.next();s.children(".selectbox-box").stop().slideUp(n.settings.speed,function(){s.css("z-index","1")});if(t!==r&&typeof t[0]==="function"){t[0]()}},toggle:function(t){var n=this,i=e(this.element),s=i.next();if(s.children(".selectbox-box").is(":visible")){n.close()}else{n.open()}if(t!==r&&typeof t[0]==="function"){t[0]()}}};e.fn[i]=function(t){var n=Array.prototype.slice.call(arguments,1);var r=["val","open","close","toggle"];if(e.data(this[0],"plugin_"+i)&&typeof t==="string"){if(e.inArray(t,r)!==-1){return e.data(this[0],"plugin_"+i)[t](n)}else{throw"Function do not exists"}}else{this.each(function(){if(!e.data(this,"plugin_"+i)){e.data(this,"plugin_"+i,new o(this,t))}});return this}}})(jQuery,window,document)